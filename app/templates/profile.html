{% extends "base.html" %}

{% block head %}
    <link rel="stylesheet" href="/css/jquery-ui-flick.css?v=2">    
    <link rel="stylesheet" type="text/css" href="/css/wmd.css" />
{% endblock %}

{% block scripts %}
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>
    <script src="/js/libs/wmd.js"></script>
    <script src="/js/libs/jquery-wmd-plugin.js"></script>
    <script src="/js/libs/showdown.js"></script>    

    <script>
    $(function() {
        $("#tabs").tabs({% if tab2 %}{ selected:1 }{% endif %});
		$(".btn_small").button();        

	    $("#about").wmd({
	        "preview": true,
	        "helpLink": "http://stackoverflow.com/editing-help",
	        "helpHoverTitle": "Markdown Help",
	    });
    });
    </script>
{% endblock %}

{% block main %}
    <h1>Account Settings</h1>
    <small style="color:gray;">You are a member since {{ prefs.date_joined|timesince }}<br> (<a href="/authors/{{ prefs.nickname }}">public profile</a> | <a href="/logout">sign out</a>)</small>
    
    <div id="tabs" style="margin:20px 10px;">
    	<ul>
    		<li><a href="#tabs-1">About</a></li>
    		<li><a href="#tabs-2">Notifications</a></li>
    	</ul>
    	<div id="tabs-1">
            <p>     
            <form action="/profile" method="post">
            <input type="hidden" name="update" value="about" />
            <table class="padX">
                <tr><td>Avatar</td><td><img src="http://www.gravatar.com/avatar/{{ prefs.email_md5 }}?s=20" /> <small style="color:gray; padding-left:10px;">(from <a href="http://gravatar.com">gravatar.com</a>)</small></td></tr>
                <tr><td>Nickname</td><td>
                    <input type="text" name="nickname" value="{{ prefs.nickname }}" />
                    {% if error2 %}<small style="color:gray;">Only your own email is permitted as username</small>{% endif %}                    
                </td></tr>
                <tr><td>Email</td><td>
                    <input type="text" name="email" value="{{ prefs.email }}" disabled=true />
                    <small style="color:gray;">We are working on email verification, <a href="/about/contact">contact us</a> in the meantime.</small>                    
                </td></tr>
                <!--<tr><td>Twitter</td><td><input type="text" name="twitter" value="{{ prefs.twitter }}"/></td></tr>-->
                <tr><td>About you</td><td><textarea name="about" id="about" rows="12" cols="65">{{ prefs.about }}</textarea></td></tr>
                <tr><td></td><td><input type="submit" value="Apply" class="btn_small" /></td></tr>
            </table>    
            </form>
            </p>
    	</div>
    	<div id="tabs-2">
            <p style="padding-top:10px;">
            Send me an email when
            <form action="/profile" method="post">
            <input type="hidden" name="update" value="notifications" />
            <table class="padX">
                <tr><td><input type="checkbox" name="n0" value="1" {{ prefs.notifications|is_notification:1 }} id="n1" /></td><td><label for="n1">Someone suggest an edit on one of my snippets</label></td></tr>
                <tr><td><input type="checkbox" name="n1" value="1" {{ prefs.notifications|is_notification:2 }} id="n2" /></td><td><label for="n2">Someone comments on one of my snippets</label></td></tr>
                <tr><td><input type="checkbox" name="n2" value="1" {{ prefs.notifications|is_notification:4 }} id="n3" /></td><td><label for="n3">Someone comments on any snippet i've commented on</label></td></tr>
                <tr><td><input type="checkbox" name="n3" value="1" {{ prefs.notifications|is_notification:8 }} id="n4" /></td><td><label for="n4">Someone edits or comments on a snippet i follow</label></td></tr>
                <tr><td colspan='2'></td></tr>
                <tr><td colspan='2'><input type="submit" value="Apply" class="btn_small" /></td></tr>
            </table>    
            </form>
            </p>
    	</div>
    	<div id="tabs-3">
            <p></p>
    	</div>
    </div>
{% endblock %}